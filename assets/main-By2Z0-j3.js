import{v as l,i as h,a as p}from"./mock-BP7nJdv-.js";let t=JSON.parse(localStorage.getItem("chat"));(!t||t.length===0)&&(localStorage.setItem("chat",JSON.stringify(l)),t=l);const a=document.querySelector("form"),i=a.querySelector(".form__message"),r=i.querySelector(".form-input"),c=i.querySelector(".form-input-mirror-text"),o=document.querySelector(".messages"),y=document.querySelector("#message-template").content.querySelector(".message"),f=a.querySelector(".icon-send"),m=({type:e,message:s,timestamp:d,status:g})=>{const n=y.cloneNode(!0);if(n.querySelector(".message-text").textContent=s,n.querySelector(".message-time").textContent=new Intl.DateTimeFormat("ru",{hour:"numeric",minute:"numeric"}).format(new Date(d)),e==="input")switch(n.classList.add("message_input"),g){case"read":n.querySelector(".message-status").src=p;break;case"sent":n.querySelector(".message-status").src=h;break}return n},u=e=>{e.preventDefault();const s={id:t.length+1,type:"input",sender:"Бараш",message:r.value,timestamp:new Date,status:"sent"};t.push(s),localStorage.setItem("chat",JSON.stringify(t)),r.value="",c.textContent="",o.style.removeProperty("height"),r.style.removeProperty("height"),o.append(m(s)),o.lastElementChild.scrollIntoView({block:"end",behavior:"smooth"})},S=e=>{e.keyCode===13&&!e.shiftKey&&(e.preventDefault(),a.dispatchEvent(new Event("submit")))},v=t.findIndex(e=>e.status==="sent"&&e.type==="output");a.addEventListener("submit",u);a.addEventListener("keypress",S);f.addEventListener("click",u);r.addEventListener("input",e=>{c.textContent=e.target.value;const s=e.target.value.endsWith(`
`);r.style.height=`calc(${c.offsetHeight}px + ${s?1.15:0}em)`,o.style.height=`calc(100dvh - 60px - ${i.offsetHeight}px - 21px - 10px)`});for(const e of t)o.append(m(e));o.children[v].scrollIntoView({block:"end",behavior:"smooth"});
